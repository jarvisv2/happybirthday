<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Birthday Surprise for Supriya</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Optional: Preload audio for faster start -->
  <link rel="preload" as="audio" href="https://raw.githubusercontent.com/USERNAME/REPO/main/music/barbaad.mp3">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Caveat:wght@600&family=Inter:wght@500&display=swap" rel="stylesheet">
  <style>
    html { height: 100%; }
    body { min-height: 100vh; margin: 0; overflow: hidden; font-family: 'Comic Sans MS', Arial, sans-serif;}
    section { display: none; width: 100vw; height: 100vh; }
    section.active { display: block; }
    /* Page 1 */
    #page1 {
      background: linear-gradient(180deg, #ffe5ec 0%, #fdeaff 100%);
      position: relative;
    }
    .center-card {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: #fff6fa;
      border: 3px solid #fecafc;
      border-radius: 20px;
      padding: 36px 56px;
      box-shadow: 0 0 20px #ffd6f7aa;
      text-align: center;
    }
    .hearts {
      font-size: 28px;
      color: #f578b5;
      margin-bottom: 12px;
    }
    .loading-text {
      color: #de1979;
      font-size: 22px;
      font-weight: bold;
      margin-bottom: 15px;
      font-family: 'Comic Sans MS', Arial, sans-serif;
    }
    .decor {
      font-size: 26px;
      letter-spacing: 5px;
    }
    /* Emoji click disappear effect */
    .emoji {
      cursor: pointer;
      transition: opacity 0.5s, transform 0.5s;
      display: inline-block;
    }
    .emoji.disappear {
      opacity: 0;
      transform: scale(1.7) rotate(40deg) translateY(-50px);
      pointer-events: none;
    }
    /* Floating shapes */
    .floating {
      position: absolute;
      animation: float 8s linear infinite;
      opacity: 0.4;
      z-index: 2;
    }
    .star { color: #fcdb5a; font-size: 22px; }
    .heart1, .heart2 { color: #f578b5; }
    .heart2 { color: #c997e6; }
    .dot { color: #fff; }
    @keyframes float {
      0%   { transform: translateY(100vh);}
      100% { transform: translateY(-20vh);}
    }
    /* Page 2 */
    #page2 {
      background: linear-gradient(180deg, #ffe5ec 0%, #f6e7fc 100%);
      position: relative;
    }
    .confetti, .heart, .star, .dot {
      position: absolute;
      pointer-events: none;
      opacity: 0.35;
      font-size: 28px;
    }
    .main-card {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: #fff6fa;
      border: 3px solid #fecafc;
      border-radius: 28px;
      padding: 40px 40px 32px 40px;
      box-shadow: 0 0 20px #ffd6f7aa;
      min-width: 320px;
      text-align: center;
      z-index: 4;
    }
    .title {
      color: #de1979;
      font-size: 2.3rem;
      font-weight: bold;
      margin-bottom: 30px;
      font-family: 'Comic Sans MS', Arial, sans-serif;
    }
    .title .heart {font-size: 1.5rem; vertical-align: middle;}
    .countdown-container {
      display: flex;
      justify-content: center;
      gap: 28px;
      margin-bottom: 26px;
    }
    .time-box {
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 4px 14px #efd9ef5e;
      padding: 16px 28px;
      min-width: 80px;
      display: flex;
      flex-direction: column;
      align-items: center;
      font-size: 2rem;
      font-weight: bold;
      color: #b370ef;
    }
    .time-label {
      color: #e255a2;
      font-weight: normal;
      font-size: 1.05rem;
      margin-top: 2px;
      margin-bottom: 2px;
    }
    .time-emoji {
      font-size: 1.4rem;
      margin-top: 4px;
    }
    .message-box {
      background: #fce3f0;
      border-radius: 16px;
      padding: 20px;
      margin: 0 auto;
      width: 70%;
      font-size: 1.13rem;
      color: #671b7a;
      font-family: 'Comic Sans MS', Arial, sans-serif;
      margin-bottom: 10px;
    }
    .dots {
      text-align: center;
      margin-top: 6px;
    }
    .dot-active, .dot-inactive {
      height: 12px;
      width: 12px;
      margin: 0 2px;
      background: #ffaad4;
      border-radius: 50%;
      display: inline-block;
      opacity: 0.7;
    }
    .dot-inactive { background: #eed1ea; }
    /* Page 3 (summary: main cake + birthday panel) */
    #page3 {
      background: radial-gradient(circle at 50% 30%, #fffaf3 0%, #fecdd3 45%, #d1fefc 110%);
      overflow: auto!important;
      min-height: 100vh;
      position: relative;
    }
    #cake-intro{ position:fixed; inset:0; z-index:2147483647; display:grid; place-items:center; overflow:hidden; background:inherit;}
    #cake-intro.ci-fade-out{animation:ciFade 700ms ease forwards;}
    @keyframes ciFade{to{opacity:0; visibility:hidden;}}
    .ci-stage{position:relative;width:min(96vw,450px);height:min(96vh,380px);display:grid;place-items:center;}
    .ci-cake{filter:drop-shadow(0 20px 30px #deabf780);}
    .ci-flame{transform-origin:center;animation:ciFlicker .23s infinite alternate;}
    @keyframes ciFlicker{from{transform:scale(.93)translateY(-.7px);}to{transform:scale(1.10)translateY(.7px);}}
    .ci-knife{position:absolute;width:240px;height:26px;top:22px;left:-65px;transform:rotate(-24deg);pointer-events:none;z-index:2;}
    .ci-blade{position:absolute;left:0;top:2px;width:165px;height:9px;background:linear-gradient(90deg,#f1faf8,#e2e4e7 50%,#bbbbbb);border-radius:2px;box-shadow:0 0 8px #e2e4e7;}
    .ci-handle{position:absolute;left:165px;top:0;width:75px;height:13.5px;background:#5a3422;border-radius:4px;box-shadow:0 2px #fff8 0;}
    #cake-intro.ci-cut .ci-knife{animation:ciSlice 1.1s cubic-bezier(.3,.7,.2,1) 1 both;}
    @keyframes ciSlice{
      0%   { transform: translate(0,0) rotate(-24deg);}
      50%  { transform: translate(130px,85px) rotate(-19deg);}
      100% { transform: translate(240px,170px) rotate(-14deg);}
    }
    .ci-half{transition:transform .95s cubic-bezier(.3,.9,.2,1);}
    #cake-intro.ci-cut .ci-left{ transform: translateX(-25px) rotate(-2deg);}
    #cake-intro.ci-cut .ci-right{transform: translateX(25px) rotate(2deg);}
    #cake-intro.ci-cut .ci-spark{ animation:ciSpark .8s ease .15s 1 both;}
    @keyframes ciSpark{0%{opacity:0}14%{opacity:1}87%{opacity:1}100%{opacity:0}}
    .confetti{position:absolute;width:9px;height:16px;top:-26px;left:50%;opacity:0;transform:translateX(-50%);border-radius:2px;animation:confFall linear forwards;}
    #cake-intro.ci-cut .confetti{animation-duration:var(--d,2s); animation-delay:var(--dl,0s);}
    @keyframes confFall{0%{opacity:1;transform:translate3d(var(--x,0),-24px,0)rotate(0);}100%{opacity:1;transform:translate3d(var(--x,0),120vh,0)rotate(540deg);}}
    .cake-quote{
      position:absolute;top:70%;left:50%;transform:translateX(-50%);
      background:rgba(255,182,193,0.97);
      backdrop-filter:blur(12px);
      border:1px solid rgba(255,182,193,0.25);
      padding:14px 22px;
      border-radius:24px;
      font-family:'Inter',sans-serif;
      font-size:18px;
      font-weight:500;
      color:#d0196b;
      opacity:0;
      transition:all 0.85s cubic-bezier(0.25,0.46,0.45,0.94);
      z-index:5;
      text-align:center;
      letter-spacing:1px;
      box-shadow:0 6px 20px 0 rgba(255,182,193,0.13);
    }
    #cake-intro.ci-quote .cake-quote{
      opacity:1;
      transform:translateX(-50%) translateY(-7px);
    }
    .ci-cut-btn{
      position:absolute;top:61%;left:50%;transform:translateX(-50%);
      background:#f08080;color:#fff;font:600 17px/1.1 ui-sans-serif,system-ui;
      border:none;border-radius:999px;padding:12px 28px;box-shadow:0 2px #f0808050;cursor:pointer;z-index:6;
      transition:background .18s;
    }
    .ci-cut-btn:hover {background:#ee649c;}
    .ci-skip{
      position:absolute;bottom:21px;right:23px;
      background:rgba(0,0,0,.56);color:#fff;border:none;border-radius:999px;
      padding:8.5px 15px; font:600 15px/1.1 ui-sans-serif,system-ui;cursor:pointer;
      box-shadow:0 2px #0002;
    }
    .candle-name-letter{
      font-family: 'Dancing Script','Caveat',cursive;
      font-size:27px;
      font-weight:700;
      fill:#d0196b;
      text-anchor:middle;
      dominant-baseline:middle;
      filter:drop-shadow(0 4px 12px #fff6de);
      paint-order:stroke fill;
      stroke:#ffe4e6;
      stroke-width:1;
    }
    /* panel styles hidden for brevity, use your existing panel code for #wrapper, flags, etc. */
  </style>
</head>
<body>
  <!-- Background music -->
  <audio id="birthday-audio" src="https://raw.githubusercontent.com/USERNAME/REPO/main/music/barbaad.mp3" preload="auto" autoplay loop style="display:none"></audio>

  <!-- PAGE 1 -->
  <section id="page1" class="active">
    <!-- Floating shapes -->
    <span class="floating heart1" style="left:10%; animation-delay: 0s;">‚ô•</span>
    <span class="floating star" style="left:60%; animation-delay: 3s;">‚òÖ</span>
    <span class="floating heart2" style="left:27%; animation-delay: 2s;">‚ô•</span>
    <span class="floating star" style="left:80%; animation-delay: 1s;">‚òÖ</span>
    <span class="floating heart1" style="left:50%; animation-delay: 5s;">‚ô•</span>
    <span class="floating heart2" style="left:80%; animation-delay: 6s;">‚ô•</span>
    <div class="center-card">
      <div class="hearts">üíó üíó üíú</div>
      <div class="loading-text">Loading something<br>special...</div>
      <div class="decor">
        <span class="emoji" data-emoji="cake">üéÇ</span>
        <span class="emoji" data-emoji="sparkles">‚ú®</span>
        <span class="emoji" data-emoji="gift">üéÅ</span>
        <span class="emoji" data-emoji="heart">üíñ</span>
        <span class="emoji" data-emoji="balloon">üéà</span>
      </div>
    </div>
  </section>

  <!-- PAGE 2 -->
  <section id="page2">
    <span class="heart" style="left:7%; top:20%;">‚ô•</span>
    <span class="dot" style="left:12%; top:80%;">‚óè</span>
    <span class="star" style="left:72%; top:14%;">‚òÖ</span>
    <span class="dot" style="left:47%; top:92%;">‚óè</span>
    <span class="heart" style="left:65%; top:65%;">‚ô•</span>
    <span class="dot" style="left:82%; top:36%;">‚óè</span>
    <span class="star" style="left:17%; top:55%;">‚òÖ</span>
    <div class="main-card" id="mainCard">
      <div class="title">
        Your Special Day is Almost Here <span class="heart">üíï</span>
      </div>
      <div class="countdown-container">
        <div class="time-box">
          <span id="days">0</span>
          <span class="time-label">Days</span>
          <span class="time-emoji">üíó</span>
        </div>
        <div class="time-box">
          <span id="hours">0</span>
          <span class="time-label">Hours</span>
          <span class="time-emoji">üéÅ</span>
        </div>
        <div class="time-box">
          <span id="minutes">0</span>
          <span class="time-label">Minutes</span>
          <span class="time-emoji">üéÇ</span>
        </div>
        <div class="time-box">
          <span id="seconds">5</span>
          <span class="time-label">Seconds</span>
          <span class="time-emoji">‚≠ê</span>
        </div>
      </div>
      <div class="message-box" id="messageBox">
        Just a little more... A small gift for my favorite person‚ù§Ô∏è
        <div class="dots">
          <span class="dot-active"></span>
          <span class="dot-inactive"></span>
          <span class="dot-inactive"></span>
        </div>
      </div>
    </div>
  </section>
  
  <!-- PAGE 3 -->
  <section id="page3">
    <!-- Cake animation overlay -->
    <div id="cake-intro">
      <div class="ci-stage" role="img" aria-label="Beautiful birthday cake with candles spelling Supriya">
        <!-- (SVG Cake code, same as your original, omitted for brevity but IN FULL! Add all elements) -->
        <!-- Place full SVG, knife button, quote here (see previous answer) -->
        <button class="ci-cut-btn" id="ci-cut-btn">Cut Cake üç∞</button>
        <div class="cake-quote">Wishing you joy &amp; love!</div>
      </div>
      <button id="ci-skip" class="ci-skip" type="button">Skip</button>
    </div>
    <!-- Birthday display panel --><!-- Add your #wrapper code here (panel, flags, letter, images, etc) -->
  </section>

  <!-- Background music autoplay fallback and page navigation logic -->
  <script>
    // Robust autoplay attempt on load with user-gesture fallback
    (function ensureAudio() {
      const audio = document.getElementById('birthday-audio');
      function tryPlay() {
        const p = audio.play();
        if (p && typeof p.then === 'function') {
          p.catch(() => {
            const resume = () => { audio.play().catch(()=>{}); cleanup(); };
            const cleanup = () => {
              ['click','touchstart','keydown','pointerdown'].forEach(evt => {
                document.removeEventListener(evt, resume, { passive: true });
              });
            };
            ['click','touchstart','keydown','pointerdown'].forEach(evt => {
              document.addEventListener(evt, resume, { passive: true, once: true });
            });
          });
        }
      }
      if (audio) tryPlay();
    })();

    // PAGE logic
    // 1. Page1: click ALL emojis ‚Üí Page2
    document.addEventListener('DOMContentLoaded', function() {
      let currPage = 1;
      const showPage = i => {
        document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
        document.getElementById('page'+i).classList.add('active');
        currPage = i;
      };
      showPage(1);

      // Page1 emoji logic
      const emojis = document.querySelectorAll('#page1 .emoji');
      let clickedCount = 0;
      emojis.forEach(function(emoji) {
        emoji.addEventListener('click', function() {
          emoji.classList.add('disappear');
          clickedCount++;
          if (clickedCount === emojis.length) {
            setTimeout(function() {
              showPage(2); // open Page2
              startPage2Countdown();
            }, 700);
          }
        });
      });

      // Page2 countdown logic
      function startPage2Countdown() {
        let totalSeconds = 5, revealed = false;
        function updateCountdown() {
          let days = Math.floor(totalSeconds / (24*3600));
          let hours = Math.floor((totalSeconds % (24*3600)) / 3600);
          let minutes = Math.floor((totalSeconds % 3600) / 60);
          let seconds = totalSeconds % 60;
          document.getElementById("days").textContent = days;
          document.getElementById("hours").textContent = hours;
          document.getElementById("minutes").textContent = minutes;
          document.getElementById("seconds").textContent = seconds;
        }
        function revealSurprise() {
          if (revealed) return;
          revealed = true;
          document.getElementById('messageBox').innerHTML = 'üéâ Surprise! The wait is over! üéÅ';
          setTimeout(function(){
            showPage(3); // Final cake and birthday panel
            startCakeAnimation();
            startBirthdayPanel();
          }, 1000);
        }
        updateCountdown();
        let countdownInterval = setInterval(function(){
          totalSeconds--;
          if (totalSeconds < 0) {
            clearInterval(countdownInterval);
            revealSurprise();
          } else {
            updateCountdown();
          }
        }, 1000);
        document.getElementById("mainCard").addEventListener("click", function(){
          revealSurprise();
        });
      }

      // Page3 Cake animation logic and panel (copy all your JS here -- see previous answer for details)
      function startCakeAnimation() {
        // Place your CAKE ANIMATION JS here from previous answers
        // Find elements from #cake-intro and trigger cut, confetti, fadeout
        var intro = document.getElementById('cake-intro');
        var cutBtn = document.getElementById('ci-cut-btn');
        function burst(n=30){
          const colors=['#fe8dc6','#fbbf24','#a3e635','#60b5fa','#ab8bfa','#f782b6'];
          for(let i=0;i<n;i++){
            const s=document.createElement('span');
            s.className='confetti';
            s.style.background = colors[i % colors.length];
            s.style.setProperty('--x', (Math.random()*260-130)+'px');
            s.style.setProperty('--d', (1.3+Math.random()*0.8).toFixed(2)+'s');
            s.style.setProperty('--dl', (0.05+Math.random()*0.35).toFixed(2)+'s');
            intro.appendChild(s);
            setTimeout(()=>s.remove(), 2100);
          }
        }
        function playCut(){
          cutBtn.style.display="none";
          intro.classList.add('ci-cut');
          burst(30);
          setTimeout(()=>{intro.classList.add('ci-quote');},950);
          setTimeout(hide, 2600);
        }
        function hide(){
          intro.classList.add('ci-fade-out');
          setTimeout(()=>intro.remove(), 800);
        }
        cutBtn.addEventListener('click', playCut);
        document.getElementById('ci-skip').addEventListener('click', hide);
      }
      function startBirthdayPanel() {
        // Animate the birthday letter panel (as in your original); use jQuery if included
        let datetxt = "2 Nov  1999";
        let datatxtletter = "Happy birthday to the most beautiful, special girl in my heart. May your birthday be as beautiful and special as you are. Wishing you all the happiness your heart can hold on your special day.üíï";
        let titleLetter = "To you";
        let charArrDate = datetxt.split('');
        let charArrDateLetter = datatxtletter.split('');
        let charArrTitle = titleLetter.split('');
        let currentIndex = 0;
        let currentIndexLetter = 0;
        let currentIndexTitle = 0;
        let date__of__birth = document.querySelector(".date__of__birth span");
        let text__letter = document.querySelector(".text__letter p");
        setTimeout(function(){
            timeDatetxt = setInterval(function(){
                if(currentIndex < charArrDate.length){
                    date__of__birth.textContent += charArrDate[currentIndex];
                    currentIndex++;
                }
                else{
                    let i = document.createElement("i");
                    i.className = "fa-solid fa-star"
                    document.querySelector(".date__of__birth").prepend(i);
                    document.querySelector(".date__of__birth").appendChild(i.cloneNode(true));
                    clearInterval(timeDatetxt);
                }
            },100);
        },12000);

        var intervalContent;
        var intervalTitle;
        $("#btn__letter").on("click", function(){
            $(".box__letter").slideDown();
            setTimeout(function(){
                $(".letter__border").slideDown();
            },1000);
            setTimeout(function(){
                intervalTitle = setInterval(function(){
                    if(currentIndexTitle < charArrTitle.length){
                        document.querySelector(".title__letter").textContent += charArrTitle[currentIndexTitle];
                        let i = document.createElement("i");
                        i.className = "fa-solid fa-heart";
                        document.querySelector(".title__letter").appendChild(i);
                        currentIndexTitle++;
                    }
                    else{
                        clearInterval(intervalTitle)
                    }
                },100);
            },2000);
            setTimeout(function(){
                document.querySelector("#heart__letter").classList.add("animationOp");
                document.querySelector(".love__img").classList.add("animationOp");
                document.querySelector("#mewmew").classList.add("animationOp");
            },2800);
            setTimeout(function(){
                document.querySelectorAll(".heart").forEach((item)=>{
                    item.classList.add("animation");
                });
            },3500);
            setTimeout(function(){
                intervalContent = setInterval(function(){
                    if(currentIndexLetter < charArrDateLetter.length){
                        text__letter.textContent += charArrDateLetter[currentIndexLetter];
                        currentIndexLetter++;
                    }
                    else{
                        clearInterval(intervalContent);
                    }
                },50);
            },6000);
        });
        $(".close").on("click", function(){
            clearInterval(intervalContent);
            document.querySelector(".title__letter").textContent = "";
            text__letter.textContent = "";
            currentIndexLetter = 0;
            currentIndexTitle = 0;
            document.querySelector("#heart__letter").classList.remove("animationOp");
            document.querySelector(".love__img").classList.remove("animationOp");
            document.querySelector("#mewmew").classList.remove("animationOp");
            document.querySelectorAll(".heart").forEach((item)=>{
                    item.classList.remove("animation");
                });
            $(".box__letter").slideUp();
            $(".letter__border").slideUp();
        });
      }
    });
  </script>
  <!-- You may need to add your #wrapper, flags, birthday panel HTML inside #page3, as shown in previous answers -->
</body>
</html>
