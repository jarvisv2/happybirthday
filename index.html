<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="title" content="Happy Birthday | darkshadeoflove">
  <title>HBD | darkshadeoflove</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- External styles/scripts your scene expects -->
  <link rel="stylesheet" href="style.css"><!-- your custom stylesheet -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"
          integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
          crossorigin="anonymous"></script>

  <style>
    /* Base look and countdown card */
    :root {
      --bg: #0b1220;
      --panel: rgba(255,255,255,0.06);
      --border: rgba(255,255,255,0.10);
      --fg: #e6e9f0;
      --muted: #a7b0c0;
      --accent: #ff69b4;
      --accent-2: #9b87f5;
      --cake: #f7c7d9;
      --cake-top: #ffe4ef;
      --cake-cream: #fff3f8;
      --choc: #7b4b3a;
      --plate: #e9edf5;
      --flame-core: #fff6b7;
      --flame-mid: #ffbf5e;
      --flame-outer: #ff7c2a;
      --shadow: rgba(0,0,0,0.25);
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: radial-gradient(1200px 600px at 50% -20%, #1b2340 0%, #0b1220 55%, #060a14 100%);
      color: var(--fg);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      display: grid;
      place-items: center;
      padding: 24px;
    }
    .wrap { width: min(920px, 100%); }
    .card {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 22px;
      backdrop-filter: blur(6px);
      box-shadow: 0 10px 30px var(--shadow);
    }
    .title {
      display: flex; align-items: center; gap: 12px;
      font-weight: 700; font-size: 20px; letter-spacing: .2px; margin: 0 0 14px 0;
    }
    .subtitle { margin: 0 0 18px 0; color: var(--muted); font-size: 14px; }
    .count-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 14px; }
    @media (max-width: 520px) { .count-grid { grid-template-columns: repeat(2, 1fr); } }
    .unit {
      background: rgba(255,255,255,0.04);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 18px 14px;
      text-align: center;
    }
    .val { font-size: clamp(28px, 6vw, 46px); font-weight: 800; letter-spacing: 0.5px; line-height: 1; color: var(--fg); }
    .label { margin-top: 8px; font-size: 12px; text-transform: uppercase; letter-spacing: 1px; color: var(--muted); }
    .progress { margin-top: 18px; height: 10px; background: rgba(255,255,255,0.05); border: 1px solid var(--border); border-radius: 9999px; overflow: hidden; }
    .bar { height: 100%; width: 0%; background: linear-gradient(90deg, var(--accent), var(--accent-2)); transition: width .4s ease; }
    .footer { display: flex; justify-content: space-between; gap: 12px; margin-top: 18px; color: var(--muted); font-size: 13px; flex-wrap: wrap; }
    .celebrate { margin-top: 18px; background: linear-gradient(90deg, var(--accent), var(--accent-2)); color: #100b1a; font-weight: 800; border: none; border-radius: 12px; padding: 12px 16px; cursor: pointer; }

    /* Celebration modal */
    .backdrop {
      position: fixed; inset: 0; background: rgba(0,0,0,0.78);
      display: none; align-items: center; justify-content: center; padding: 20px; z-index: 60;
    }
    .stage {
      width: min(1000px, 96vw);
      background: linear-gradient(180deg, rgba(255,255,255,0.07), rgba(255,255,255,0.03));
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 12px 40px var(--shadow);
    }
    .stage-grid {
      display: grid; grid-template-columns: 1.2fr 1fr; gap: 16px;
    }
    @media (max-width: 860px) { .stage-grid { grid-template-columns: 1fr; } }
    .panel {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 14px;
      padding: 10px;
    }
    .player { aspect-ratio: 16 / 9; background: #000; width: 100%; border-radius: 10px; overflow: hidden; }
    .player-controls { display: flex; gap: 8px; margin-top: 8px; flex-wrap: wrap; }
    .btn {
      padding: 8px 12px; border-radius: 8px; border: 1px solid var(--border);
      background: rgba(255,255,255,0.06); color: var(--fg); cursor: pointer;
    }

    /* Cake */
    .cake-wrap { display: grid; place-items: center; padding: 10px; }
    .plate { width: 340px; height: 24px; background: var(--plate); border-radius: 999px; filter: drop-shadow(0 8px 12px rgba(0,0,0,0.35)); }
    .cake { position: relative; width: 300px; height: 160px; margin-top: -12px; display: grid; place-items: center; }
    .cake-body {
      position: absolute; bottom: 16px; width: 300px; height: 120px; background: var(--cake);
      border-radius: 14px; box-shadow: inset 0 -10px 0 var(--choc), 0 6px 14px var(--shadow); transition: transform .6s ease;
    }
    .cake-top {
      position: absolute; bottom: 120px; width: 300px; height: 40px; background: var(--cake-top);
      border-radius: 18px 18px 12px 12px; box-shadow: 0 4px 10px var(--shadow); transition: transform .6s ease;
    }
    .drip {
      position: absolute; top: -6px; width: 16px; height: 26px; background: var(--cake-cream);
      border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.15);
    }
    .drip.d1 { left: 48px; height: 22px; }
    .drip.d2 { left: 96px; height: 28px; }
    .drip.d3 { left: 160px; height: 24px; }
    .drip.d4 { left: 220px; height: 30px; }

    .candle { position: absolute; bottom: 148px; left: 50%; transform: translateX(-50%); width: 14px; height: 54px;
      background: repeating-linear-gradient(180deg, #fff, #fff 6px, #ffd3e5 6px, #ffd3e5 12px);
      border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.25); display: grid; place-items: center; }
    .wick { width: 2px; height: 10px; background: #222; margin-top: 2px; }

    .flame { position: absolute; bottom: 58px; left: 50%; transform: translateX(-50%); width: 10px; height: 22px;
      filter: drop-shadow(0 0 8px #ffb347) drop-shadow(0 0 16px #ff944d); }
    .flame:before, .flame:after {
      content: ""; position: absolute; left: 50%; transform: translateX(-50%); border-radius: 50%;
      animation: flicker 1.2s infinite ease-in-out;
    }
    .flame:before { width: 10px; height: 22px; background: radial-gradient(50% 60% at 50% 60%, var(--flame-core) 0%, var(--flame-mid) 55%, transparent 70%); opacity: 0.95; }
    .flame:after  { width: 18px; height: 28px; top: -3px; background: radial-gradient(45% 60% at 50% 60%, rgba(255,255,255,0.65) 0%, var(--flame-outer) 55%, transparent 70%); filter: blur(0.6px); opacity: 0.8; }
    @keyframes flicker {
      0% { transform: translateX(-50%) translateY(0) scale(1); opacity: 0.95; }
      50% { transform: translateX(calc(-50% + 1.8px)) translateY(-1.5px) scale(1.05); opacity: 1; }
      100% { transform: translateX(calc(-50% - 1.4px)) translateY(0.5px) scale(0.98); opacity: 0.92; }
    }
    .flame.off { display: none; }

    .slice { position: absolute; bottom: 16px; left: 50%; transform: translateX(-50%) translateY(0); width: 90px; height: 120px; overflow: visible; pointer-events: none; opacity: 0; }
    .slice .piece { width: 90px; height: 120px; background: var(--cake); border-radius: 8px; box-shadow: inset 0 -10px 0 var(--choc), 0 6px 14px var(--shadow);
      clip-path: polygon(50% 0%, 100% 15%, 100% 85%, 50% 100%, 0% 85%, 0% 15%); }
    .slice .top { position: absolute; top: -40px; left: 0; width: 90px; height: 40px; background: var(--cake-top); border-radius: 12px; }

    .crumbs { position: absolute; bottom: 8px; left: 46%; width: 100px; height: 40px; pointer-events: none; opacity: 0; }
    .crumbs i { position: absolute; width: 6px; height: 6px; background: var(--choc); border-radius: 50%; opacity: 0.9; transform: translateY(0); filter: blur(0.1px); }
    .crumbs i:nth-child(1){ left: 6px; animation: crumb 1.2s ease forwards; }
    .crumbs i:nth-child(2){ left: 22px; animation: crumb 1.2s .08s ease forwards; }
    .crumbs i:nth-child(3){ left: 38px; animation: crumb 1.2s .12s ease forwards; }
    .crumbs i:nth-child(4){ left: 54px; animation: crumb 1.2s .18s ease forwards; }
    .crumbs i:nth-child(5){ left: 70px; animation: crumb 1.2s .22s ease forwards; }
    @keyframes crumb { 40% { transform: translateY(-10px); opacity: 1; } 100% { transform: translateY(6px); opacity: 0; } }

    .cutting .cake-top { transform: translateX(-8px); }
    .cutting .cake-body { transform: translateX(-8px); }
    .slice.show { opacity: 1; animation: liftSlice 1.1s ease forwards; }
    @keyframes liftSlice {
      0% { transform: translateX(-50%) translateY(0) rotate(0deg); }
      50% { transform: translateX(-50%) translateY(-30px) rotate(-4deg); }
      100% { transform: translateX(-130%) translateY(10px) rotate(-8deg); }
    }
    .crumbs.show { opacity: 1; }

    .action-row { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }

    /* The "darkshadeoflove" scene wrapper starts hidden until after cake cut */
    #wrapper { display: none; }
  </style>
</head>
<body>
  <!-- COUNTDOWN CARD -->
  <main class="wrap" id="countdownView">
    <section class="card" aria-live="polite">
      <h1 class="title">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#ff69b4" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <path d="M12 2v4" />
          <path d="M9.5 4c0 1.38 1.12 2.5 2.5 2.5S14.5 5.38 14.5 4 13.38 1.5 12 1.5 9.5 2.62 9.5 4z" />
          <path d="M6 12h12a3 3 0 0 1 3 3v4a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3v-4a3 3 0 0 1 3-3z" />
          <path d="M6 12v-1a6 6 0 0 1 12 0v1" />
        </svg>
        Countdown to Birthday
      </h1>
      <p class="subtitle">At zero: song + cake scene → then your special page appears after cutting. Click Unmute to hear music. 🎂</p>

      <div class="count-grid" role="group" aria-label="Countdown time units">
        <div class="unit"><div id="days" class="val">00</div><div class="label">Days</div></div>
        <div class="unit"><div id="hours" class="val">00</div><div class="label">Hours</div></div>
        <div class="unit"><div id="minutes" class="val">00</div><div class="label">Minutes</div></div>
        <div class="unit"><div id="seconds" class="val">00</div><div class="label">Seconds</div></div>
      </div>

      <div class="progress" aria-label="Progress toward birthday">
        <div id="bar" class="bar"></div>
      </div>

      <div class="footer">
        <span>Target: <strong id="targetLabel"></strong></span>
        <span id="status">Counting down…</span>
      </div>

      <button id="celebrateBtn" class="celebrate" disabled>Celebrate now</button>
    </section>
  </main>

  <!-- CELEBRATION MODAL: YouTube + Cake -->
  <div id="celebrateModal" class="backdrop" aria-hidden="true">
    <div class="stage">
      <div class="stage-grid">
        <div class="panel">
          <div id="ytPlayer" class="player"></div>
          <div class="player-controls">
            <button id="btnUnmute" class="btn">Unmute</button>
            <button id="btnPause" class="btn">Pause</button>
            <button id="btnReplay" class="btn">Replay</button>
          </div>
        </div>
        <div class="panel">
          <div class="cake-wrap" id="cakeWrap">
            <div class="plate"></div>
            <div class="cake" id="cake">
              <div class="cake-body"></div>
              <div class="cake-top">
                <span class="drip d1"></span>
                <span class="drip d2"></span>
                <span class="drip d3"></span>
                <span class="drip d4"></span>
              </div>
              <div class="candle" id="candle">
                <div class="wick"></div>
                <div class="flame" id="flame"></div>
              </div>
              <div class="slice" id="slice">
                <div class="piece"></div>
                <div class="top"></div>
              </div>
              <div class="crumbs" id="crumbs">
                <i></i><i></i><i></i><i></i><i></i>
              </div>
            </div>
            <div class="action-row">
              <button id="btnBlow" class="btn">Blow Candle</button>
              <button id="btnLight" class="btn">Relight</button>
              <button id="btnCut" class="btn">Cut Cake</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- YOUR "darkshadeoflove" PAGE (initially hidden, shown after cake cutting) -->
  <div id="wrapper">
    <div class="flag__birthday">
      <img src="./images/1.png" alt="" width="350" class="flag__left">
      <img src="./images/1.png" alt="" width="350" class="flag__right">
    </div>
    <div class="content">
      <div class="left">
        <div class="title">
          <h1 class="happy">
            <span style="--t: 4s;">H</span>
            <span style="--t: 4.2s;">a</span>
            <span style="--t: 4.4s;">p</span>
            <span style="--t: 4.6s;">p</span>
            <span style="--t: 4.8s;">y</span>
          </h1>
          <h1 class="birthday">
            <span style="--t: 5s;">B</span>
            <span style="--t: 5.2s;">i</span>
            <span style="--t: 5.4s;">r</span>
            <span style="--t: 5.6s;">t</span>
            <span style="--t: 5.8s;">h</span>
            <span style="--t: 6s;">d</span>
            <span style="--t: 6.2s;">a</span>
            <span style="--t: 6.4s;">y</span>
          </h1>
          <div class="hat">
            <img src="./images/hat.png" alt="" width="130">
          </div>
        </div>
        <div class="date__of__birth">
          <span></span>
        </div>
        <div class="btn">
          <button id="btn__letter">
            Click here Supriya ♥️
            <i class="fa-regular fa-envelope"></i>
          </button>
        </div>
      </div>
      <div class="right">
        <div class="box__account">
          <div class="image">
            <img src="./images/r5.png" alt="">
          </div>
          <div class="name">
            <i class="fa-solid fa-heart"></i>
            <span>Supriya ♥️</span>
            <i class="fa-solid fa-heart"></i>
          </div>
          <div class="balloon_one">
            <img width="100px" src="./images/balloon1.png" alt="">
          </div>
          <div class="balloon_two">
            <img width="100px" src="./images/balloon2.png" alt="">
          </div>
        </div>
        <div class="cricle">
          <div class="text__cricle">
            <span style="--i: 1;">h</span>
            <span style="--i: 2;">a</span>
            <span style="--i: 3;">p</span>
            <span style="--i: 4;">p</span>
            <span style="--i: 5;">y</span>
            <span style="--i: 6;">-</span>
            <span style="--i: 7;">b</span>
            <span style="--i: 8;">i</span>
            <span style="--i: 9;">r</span>
            <span style="--i: 10;">t</span>
            <span style="--i: 11;">h</span>
            <span style="--i: 12;">d</span>
            <span style="--i: 13;">a</span>
            <span style="--i: 14;">y</span>
            <span style="--i: 15;">-</span>
          </div>
          <i class="fa-solid fa-heart"></i>
        </div>
      </div>
    </div>
    <div class="decorate_star star1" style="--t: 15s;"></div>
    <div class="decorate_star star2" style="--t: 15.2s;"></div>
    <div class="decorate_star star3" style="--t: 15.4s;"></div>
    <div class="decorate_star star4" style="--t: 15.6s;"></div>
    <div class="decorate_star star5" style="--t: 15.8s;"></div>
    <div class="decorate_flower--one" style="--t: 15s;">
      <img width="20" src="./images/decorate_flower.png" alt="">
    </div>
    <div class="decorate_flower--two" style="--t: 15.3s;">
      <img width="20" src="./images/decorate_flower.png" alt="">
    </div>
    <div class="decorate_flower--three" style="--t: 15.6s;">
      <img width="20" src="./images/decorate_flower.png" alt="">
    </div>
    <div class="decorate_bottom">
      <img src="./images/decorate.png" alt="" width="100">
    </div>
    <div class="smiley__icon">
      <img src="./images/smiley_icon.png" alt="" width="100">
    </div>

    <div class="box__letter">
      <div class="letter__border">
        <div class="letter">
          <div class="title__letter"></div>
          <div class="content__letter">
            <div class="left">
              <img id="heart__letter" src="https://media.giphy.com/media/YKUvclrGYmDKXwtphf/giphy.gif" alt="">
              <img class="heart heart_1" style="--t: 0.2s" width="20" src="./images/heart.png" alt="">
              <img class="heart heart_2" style="--t: 0.4s" width="20" src="./images/heart.png" alt="">
              <img class="heart heart_3" style="--t: 0.6s" width="20" src="./images/heart.png" alt="">
              <img class="heart heart_4" style="--t: 0.8s" width="20" src="./images/heart.png" alt="">
            </div>
            <div class="right">
              <div class="love__img">
                <img src="https://media.giphy.com/media/m85llaN7ZkFIHtURiC/giphy.gif" alt="" width="220">
              </div>
              <div class="text__letter">
                <p></p>
              </div>
              <img id="mewmew" width="80" src="./images/mewmew.gif" alt="">
            </div>
          </div>
        </div>
        <div class="close">
          <i class="fa-solid fa-xmark"></i>
        </div>
      </div>
    </div>
    <div id="copy">
      <p class="text-center text-white text-sm">Supriya<a href="https://www.instagram.com/@darkshadeoflove"></a></p>
    </div>
  </div>

  <script>
    // ============== Config ==============
    // Set your target date (YYYY, MM-1, DD, hh, mm)
    const TARGET = new Date(2025, 100, 27, 02, 20, 0); // Oct 27, 2026 02:20
    const START  = new Date(TARGET.getFullYear() - 1, TARGET.getMonth(), TARGET.getDate(), 0, 0, 0);
    const YT_VIDEO_ID = "kcGojPJzh1k"; // requested song

    // ============ Countdown =============
    const el = {
      days: document.getElementById('days'),
      hours: document.getElementById('hours'),
      minutes: document.getElementById('minutes'),
      seconds: document.getElementById('seconds'),
      bar: document.getElementById('bar'),
      status: document.getElementById('status'),
      label: document.getElementById('targetLabel'),
      celebrate: document.getElementById('celebrateBtn'),
      modal: document.getElementById('celebrateModal'),
      flame: document.getElementById('flame'),
      cake: document.getElementById('cake'),
      slice: document.getElementById('slice'),
      crumbs: document.getElementById('crumbs'),
      countdownView: document.getElementById('countdownView'),
      wrapper: document.getElementById('wrapper'),
    };

    function pad(n){ return n.toString().padStart(2, '0'); }
    function updateLabel() {
      const opts = { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' };
      el.label.textContent = TARGET.toLocaleString(undefined, opts);
    }
    function updateProgress(now) {
      const total = TARGET - START;
      const elapsed = Math.min(Math.max(now - START, 0), total);
      const pct = total > 0 ? (elapsed / total) * 100 : 100;
      el.bar.style.width = pct.toFixed(2) + '%';
    }

    let ticking = true;
    function tick() {
      if (!ticking) return;
      const now = Date.now();
      const diff = TARGET.getTime() - now;
      updateProgress(now);

      if (diff <= 0) {
        el.days.textContent = '00';
        el.hours.textContent = '00';
        el.minutes.textContent = '00';
        el.seconds.textContent = '00';
        el.status.textContent = 'Happy Birthday! 🎉';
        el.celebrate.disabled = false;
        ticking = false;
        openCelebration();
        return;
      }
      const d = Math.floor(diff / (1000 * 60 * 60 * 24));
      const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      const s = Math.floor((diff % (1000 * 60)) / 1000);

      el.days.textContent = pad(d);
      el.hours.textContent = pad(h);
      el.minutes.textContent = pad(m);
      el.seconds.textContent = pad(s);

      setTimeout(tick, 1000);
    }

    // ========== Celebration Scene ==========
    // Load YouTube IFrame API (autoplay muted → user can unmute)
    let ytReady = false, ytPlayer = null;
    (function loadYT() {
      const tag = document.createElement('script');
      tag.src = "https://www.youtube.com/iframe_api";
      document.head.appendChild(tag);
    })();
    window.onYouTubeIframeAPIReady = function() { ytReady = true; }; // API readiness

    function ensurePlayer() {
      if (ytPlayer) return ytPlayer;
      if (!ytReady) return null;
      ytPlayer = new YT.Player('ytPlayer', {
        videoId: YT_VIDEO_ID,
        playerVars: { autoplay: 1, controls: 1, rel: 0, modestbranding: 1, playsinline: 1, mute: 1 },
        events: { onReady: e => e.target.playVideo() }
      });
      return ytPlayer;
    }

    function openCelebration() {
      document.getElementById('celebrateModal').style.display = 'flex';
      if (!ensurePlayer()) {
        const t = setInterval(() => { if (ensurePlayer()) clearInterval(t); }, 100);
      }
      confettiBurst(); setTimeout(confettiBurst, 1000); setTimeout(confettiBurst, 2200);
    }

    // Player controls
    document.getElementById('btnUnmute').addEventListener('click', () => { if (ytPlayer) ytPlayer.unMute(); });
    document.getElementById('btnPause').addEventListener('click', () => { if (ytPlayer) ytPlayer.pauseVideo(); });
    document.getElementById('btnReplay').addEventListener('click', () => { if (ytPlayer) { ytPlayer.seekTo(0, true); ytPlayer.playVideo(); } });

    // Candle controls
    document.getElementById('btnBlow').addEventListener('click', () => { el.flame.classList.add('off'); });
    document.getElementById('btnLight').addEventListener('click', () => { el.flame.classList.remove('off'); });

    // Cut cake → then show your page
    let cutOnce = false;
    document.getElementById('btnCut').addEventListener('click', () => {
      if (cutOnce) return;
      cutOnce = true;
      el.cake.classList.add('cutting');
      el.slice.classList.add('show');
      el.crumbs.classList.add('show');
      confettiBurst();

      // After slice animation, hide modal and show your page
      setTimeout(() => {
        document.getElementById('celebrateModal').style.display = 'none';
        // Keep music playing in background if desired; comment the next two lines to continue music
        if (ytPlayer) ytPlayer.pauseVideo();
        // Switch to your scene
        el.countdownView.style.display = 'none';
        el.wrapper.style.display = 'block';
      }, 1400);
    });

    // Lightweight inline confetti
    function confettiBurst() {
      const canvas = document.createElement('canvas');
      Object.assign(canvas.style, { position: 'fixed', inset: 0, width: '100%', height: '100%', pointerEvents: 'none' });
      canvas.width = innerWidth; canvas.height = innerHeight;
      document.body.appendChild(canvas);
      const ctx = canvas.getContext('2d');
      const colors = ['#fce18a', '#ff726d', '#b48def', '#56d7c6', '#f4306d'];
      const pieces = Array.from({length: 140}, () => ({
        x: Math.random()*canvas.width, y: -10 - Math.random()*40,
        w: 6 + Math.random()*6, h: 10 + Math.random()*14,
        color: colors[(Math.random()*colors.length)|0], tilt: Math.random()*10 - 5,
        vy: 1 + Math.random()*2.5, vx: Math.random()*0.6 - 0.3,
        rot: Math.random()*360, vr: Math.random()*4 - 2
      }));
      const start = performance.now();
      function step(t) {
        const dt = (t - start);
        ctx.clearRect(0,0,canvas.width,canvas.height);
        pieces.forEach(p => {
          p.x += p.vx; p.y += p.vy; p.rot += p.vr; p.vy += 0.006;
          ctx.save(); ctx.translate(p.x, p.y); ctx.rotate(p.rot * Math.PI/180);
          ctx.fillStyle = p.color; ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h); ctx.restore();
        });
        if (dt < 4500) requestAnimationFrame(step); else canvas.remove();
      }
      requestAnimationFrame(step);
    }

    // Init countdown
    updateLabel();
    tick();

    // ===== Your letter typing logic (unchanged) =====
    let datetxt = "2 Nov 1999";
    let datatxtletter = "My love. You are a very special girl. I always silently thank you for coming into my life. Today, I wish you all the best, lots of health, and lots of joy. I always hope we will celebrate many more birthdays like this together. Happy birthday to you.💕";
    let titleLetter = "To you";
    let charArrDate = datetxt.split('');
    let charArrDateLetter = datatxtletter.split('');
    let charArrTitle = titleLetter.split('');
    let currentIndex = 0;
    let currentIndexLetter = 0;
    let currentIndexTitle = 0;
    let date__of__birth = document.querySelector(".date__of__birth span");
    let text__letter = document.querySelector(".text__letter p");
    setTimeout(function(){
      timeDatetxt = setInterval(function(){
        if(currentIndex < charArrDate.length){
          date__of__birth.textContent += charArrDate[currentIndex];
          currentIndex++;
        } else {
          let i = document.createElement("i");
          i.className = "fa-solid fa-star";
          document.querySelector(".date__of__birth").prepend(i);
          document.querySelector(".date__of__birth").appendChild(i.cloneNode(true));
          clearInterval(timeDatetxt);
        }
      },100);
    },12000);

    var intervalContent;
    var intervalTitle;
    $("#btn__letter").on("click", function(){
      $(".box__letter").slideDown();
      setTimeout(function(){ $(".letter__border").slideDown(); },1000);
      setTimeout(function(){
        intervalTitle = setInterval(function(){
          if(currentIndexTitle < charArrTitle.length){
            document.querySelector(".title__letter").textContent += charArrTitle[currentIndexTitle];
            let i = document.createElement("i");
            i.className = "fa-solid fa-heart";
            document.querySelector(".title__letter").appendChild(i);
            currentIndexTitle++;
          } else {
            clearInterval(intervalTitle);
          }
        },100);
      },2000);
      setTimeout(function(){
        document.querySelector("#heart__letter").classList.add("animationOp");
        document.querySelector(".love__img").classList.add("animationOp");
        document.querySelector("#mewmew").classList.add("animationOp");
      },2800);
      setTimeout(function(){
        document.querySelectorAll(".heart").forEach((item)=>{ item.classList.add("animation"); });
      },3500);
      setTimeout(function(){
        intervalContent = setInterval(function(){
          if(currentIndexLetter < charArrDateLetter.length){
            text__letter.textContent += charArrDateLetter[currentIndexLetter];
            currentIndexLetter++;
          } else {
            clearInterval(intervalContent);
          }
        },50);
      },6000);
    });
    $(".close").on("click", function(){
      clearInterval(intervalContent);
      document.querySelector(".title__letter").textContent = "";
      text__letter.textContent = "";
      currentIndexLetter = 0; currentIndexTitle = 0;
      document.querySelector("#heart__letter").classList.remove("animationOp");
      document.querySelector(".love__img").classList.remove("animationOp");
      document.querySelector("#mewmew").classList.remove("animationOp");
      document.querySelectorAll(".heart").forEach((item)=>{ item.classList.remove("animation"); });
      $(".box__letter").slideUp(); $(".letter__border").slideUp();
    });
  </script>
</body>
</html>

